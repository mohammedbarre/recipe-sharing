<h1>Search Recipes</h1>

<!-- Search Form -->
<form action="/api/search-recipes" method="GET" id="search-form">
    <input type="text" name="q" placeholder="Enter a recipe name or ingredient" required>
    <button type="submit">Search</button>
</form>

<!-- Results Section -->
<div id="results">
    <h2>Search Results</h2>
    <ul id="recipe-list"></ul>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('search-form');
        const recipeList = document.getElementById('recipe-list');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const query = form.querySelector('input[name="q"]').value;

            try {
                const response = await fetch(`/api/search-recipes?q=${query}`);
                const data = await response.json();

                recipeList.innerHTML = '';

                if (data.results && data.results.length > 0) {
                    data.results.forEach(recipe => {
                        const listItem = document.createElement('li');
                        listItem.innerHTML = `
                            <h3>${recipe.name}</h3>
                            <img src="${recipe.thumbnail_url}" alt="${recipe.name}" style="width: 200px;">
                            <p><a href="/api/recipe-details/${recipe.id}" target="_blank">View Details</a></p>
                        `;
                        recipeList.appendChild(listItem);
                    });
                } else {
                    recipeList.innerHTML = '<p>No recipes found. Try a different search term.</p>';
                }
            } catch (error) {
                console.error('Error fetching recipes:', error);
                recipeList.innerHTML = '<p>Failed to load recipes. Please try again.</p>';
            }
        });
    });
</script>
